{% extends 'base.html' %}
{% block content %}

<!------ Include the above in your HEAD tag ---------->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">
<div class="container">
<div class="row">
    <div class="col-sm-3">
        <a href="mail-compose.html" class="btn btn-danger  btn-compose-email">Delete User</a>
        <ul class="nav nav-pills nav-stacked nav-email shadow mb-20">
            <li class="active">
                <a href="#mail-inbox.html">
                    <i class="fa fa-inbox"></i> User Request <span class="label pull-right">7</span>
                </a>
            </li>
            <li>
                <a href="#mail-compose.html"><i class="fa fa-envelope-o"></i> Send Message</a>
            </li>
            <li>
                <a href="#"><i class="fa fa-certificate"></i> Important</a>
            </li>
            <li>
                <a href="#">
                    <i class="fa fa-file-text-o"></i> View Cleanser Detail <span class="label label-info pull-right inbox-notification">
                </a>
            </li>
            <li><a href="#"> <i class="fa fa-trash-o"></i>Delete</a></li>
        </ul><!-- /.nav -->

       
    </div>
    <div class="col-sm-9">
        
        <!-- resumt -->
        <div class="panel panel-default">
               <div class="panel-heading resume-heading">
                  <div class="row">
                     <div class="col-lg-12">
                        <div class="col-xs-12 col-sm-4">
                           <figure>
                              <img class="img-circle img-responsive" alt="" src="{{profile.image.url}}">
                           </figure>
                           <div class="row">
                              <div class="col-xs-12 social-btns">
                                 <div class="  ">
                                    <button class="btn btn-success  btn-block" id="approve">
                                    Approve deal </button>
                                 </div>
                                 <div class="  ">
                                    <button class="btn btn-danger  btn-block " id="decline">
                                    Decline Deal</button>
                                 </div>
                                 <div class="  ">
                                    <button class="btn btn-primary btn-block " id="suspend">
                                    Suspend Deal </button>
                                 </div>
                                 <div class=" ">
                                    <button class="btn btn-default btn-block " id="delete">
                                    Dealete Deal</button>
                                 </div>
                              </div>
                              
                              
                           </div>
                        </div>
                        <div class="col-xs-12 col-sm-8">
                           <ul class="list-group">
                              <li class="list-group-item"><b>First Name:</b> {{user.first_name}}</li>
                              <li class="list-group-item"><b>Last Name:</b>{{user.last_name}}</li>
                              <li class="list-group-item"><i class="fa fa-phone"></i>
                              <b></b> {{profile.mobile_no}} </li>
                              <li class="list-group-item"><i class="fa fa-envelope"></i> {{user.email}} </li>
                           </ul>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="bs-callout bs-callout-danger">
                  <h4>About Deal</h4>
                  <p>
                    {{deal.about}}
                  </p>

                        <p></p>
                     </a>
                  </ul>
               </div>
               <div class="bs-callout bs-callout-danger">
                  <h4>Deal Frameworkworks</h4>
                  <ul class="list-group">
                  {% for d in deal.framework %}
                     <li class="list-group-item"> {{d}}</li>
                     {% endfor %}
                  </ul>
                  </ul>
               </div>
               <div class="bs-callout bs-callout-danger">
                  <h4>Deal Progress</h4>
                  <ul class="list-group">
                     <a class="list-group-item inactive-link" href="#">
                     {% if deal.is_verified == True %}
                        <div class="progress">
                           <div data-placement="top" style="width:70%;" 
                              aria-valuemax="100" aria-valuemin="0" aria-valuenow="70" role="progressbar" class="progress-bar progress-bar-success">
                              <span class="sr-only">80%</span>
                              <span class="progress-type">Cleaned</span>
                           </div>
                        </div>
                        {% elif deal.is_verified == False %}
                        <div class="progress">
                           <div data-placement="top" style="width: 10%;" aria-valuemax="100" aria-valuemin="0" aria-valuenow="50" role="progressbar" class="progress-bar progress-bar-danger">
                              <span class="sr-only">10%</span>
                              <span class="progress-type">No Cleaser</span>
                           </div>
                           </div>
                        {% elif deal.status == True %}
                         <div class="progress">
                           <div data-placement="top" style="width: 80%;" 
                              aria-valuemax="100" aria-valuemin="0" aria-valuenow="100" role="progressbar" class="progress-bar progress-bar-success">
                              <span class="sr-only">100% </span>
                              <span class="progress-type">Approved</span>
                           </div>
                        </div>
                       
                      {% elif deal.valid == True%}
                       <div class="progress">
                           <div data-placement="top" style="width:100%;" 
                              aria-valuemax="100" aria-valuemin="0" aria-valuenow="100" role="progressbar" class="progress-bar progress-bar-success">
                              <span class="sr-only">100%</span>
                              <span class="progress-type">Moderated</span>
                           </div>
                        </div>
                      {% else %}
                        <div class="progress">
                           <div data-placement="top" style="width: 10%;" aria-valuemax="100" aria-valuemin="0" aria-valuenow="50" role="progressbar" class="progress-bar progress-bar-danger">
                              <span class="sr-only">100%</span>
                              <span class="progress-type">Inactive</span>
                           </div>
                           </div>
                        {% endif %}
                        </div>
                        <div class="progress-meter">
                           <div style="width: 25%;" class="meter meter-left"><span class="meter-text"> Clensing</span></div>
                           <div style="width: 25%;" class="meter meter-left"><span class="meter-text">Cleaned</span></div>
                           <div style="width: 30%;" class="meter meter-right"><span class="meter-text">Validation</span></div>
                           <div style="width: 20%;" class="meter meter-right"><span class="meter-text">Moderation</span></div>
                        </div>
                     </a>
                  </ul>
               </div>
               <div class="bs-callout bs-callout-danger">
                  <h4></h4>
                  <table class="table table-striped table-responsive ">
                     <thead>
                        <tr>
                           <th>Views</th>
                          <!-- <th>ratings</th>-->
                        <!-- <th>reviews</th>-->

                        </tr>
                     </thead>
                     <tbody>
                        <tr>
                           <td>{{deal.views}}</td>
                          <!-- <td>2014</td>-->
                        </tr>
                       <!-- <tr>
                           <td>BSc. in Computer Science and Engineering</td>
                          
                        </tr>-->
                     </tbody>
                  </table>
               </div>
            </div>
         </div>
        <!-- resume -->

    </div>
</div>
</div>
<!--AJAX Message OBJECT-->
<style>
#response{
   display:none;
}
#display{
      display:none;

}
</style>
<div id="response">
<h4 id="msg" style="text-align:center"></h4>
</div>
<div id="process">
<div class="spinner-border text-secondary" role="status">
  <span class="sr-only">Loading...</span>
</div>
</div>
<input type="hidden" id="token" vlaue="{{deal.token}}">
<script>
       var tokenz="{{deal.token}}"

$(document).ready(function(){
   

    $('#approve').click(function(){
      console.log(tokenz)
      $('#process').modal();
        $.ajax({
            type: "POST",
            url: "{%url 'Backend:dealstatus'%}",
            data: { payload: "approve", token: tokenz },
             dataType: "json",
            success:function(resp){
                $('#response').text(resp.msg)
                location.reload()
            }
            
          })
          
        $('#request').on($.modal.AJAX_SEND, function(event, modal) {
        $('#process').modal();
          });

          $('#process').on($.modal.AJAX_SUCCESS, function(event, modal) {
            $('#response').modal();
              });
    });
});

//decline
$(document).ready(function(){
    $('#decline').click(function(){

        $.ajax({
            method: "POST",
            url: "{%url 'Backend:dealstatus'%}",
            data: { payload: "decline", token: tokenz },
            success:function(resp){
                $('#msg').text(resp.msg)
                location.reload()

            }
          })
          
        $('#request').on($.modal.AJAX_SEND, function(event, modal) {
        $('#process').modal();
          });

          $('#process').on($.modal.AJAX_SUCCESS, function(event, modal) {
            $('#response').modal();
              });
    })
});
//delete
$(document).ready(function(){
    $('#delete').click(function(){

        $.ajax({
            method: "POST",
            url: "{%url 'Backend:dealstatus'%}",
            data: { payload: "approve", token: tokenz },
            success:function(resp){
                $('#msg').text(resp.msg)
                
            }
          })
          
        $('#request').on($.modal.AJAX_SEND, function(event, modal) {
        $('#process').modal();
          });

          $('#process').on($.modal.AJAX_SUCCESS, function(event, modal) {
            $('#response').modal();
              });
    })
})
//suspend 
$(document).ready(function(){
    $('#suspend').click(function(){

        $.ajax({
            method: "POST",
            url: "{%url 'Backend:dealstatus'%}",
            data: { payload: "suspend", token: tokenz },
            success:function(resp){
                $('#msg').text(resp.msg)
                location.reload()

            }
          })
          
        $('#process').on($.modal.AJAX_SEND, function(event, modal) {
        $('#response').modal();
          });

          $('#process').on($.modal.AJAX_SUCCESS, function(event, modal) {
            $('#response').modal();
              });
    })
})
</script>
{% endblock%}